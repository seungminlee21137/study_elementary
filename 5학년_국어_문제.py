import csv

# ---------------------------------------------------------
# [5학년 국어 문제 데이터베이스]
# 업로드된 '차근차근 받아쓰기_5학년6학년.txt' 내용을 분석하여 
# 헷갈리기 쉬운 맞춤법과 어휘 문제를 구성했습니다.
# ---------------------------------------------------------
quiz_data = [
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 낱말이 바르게 짝지어진 것은?",
        "context": "㉠ 정답을 짝과 함께 ( ) 것은 즐겁다.\n㉡ 친구들과 짝을 ( ) 앉았다.",
        "options": ["㉠ 맞히는, ㉡ 맞추어", "㉠ 맞추는, ㉡ 맞히어", "㉠ 맞히는, ㉡ 맞히어", "㉠ 맞추는, ㉡ 맞추어"],
        "answer": 1,
        "explanation": "문제에 대한 답을 옳게 할 때는 '맞히다', 서로 떨어져 있는 부분을 제자리에 맞게 대어 붙이거나 비교할 때는 '맞추다'를 씁니다."
    },
    {
        "type": "객관식",
        "question": "다음 중 밑줄 친 낱말의 쓰임이 올바른 것은?",
        "context": "",
        "options": ["봄바람에 흩날리는 벚꽃 잎을 눈으로 쫓았다.", "어린이들은 나비를 좇아다녔다.", "경찰이 도둑을 좇았다.", "이상적인 삶을 좇아 살았다."],
        "answer": 4,
        "explanation": "눈길이나 생각을 따를 때는 '좇다'(예: 눈으로 좇다, 꿈을 좇다), 물리적으로 잡으려고 급히 따를 때는 '쫓다'(예: 나비를 쫓다)를 씁니다. 보기 4번만 올바른 쓰임입니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 말로 알맞은 것은?",
        "context": "내 잘못은 인정하고 ( ) 사과를 전하자.",
        "options": ["심심한", "심심찮은", "시답잖은", "지루한"],
        "answer": 1,
        "explanation": "여기서 '심심(甚深)한'은 '마음의 표현 정도가 매우 깊고 간절하다'는 뜻입니다."
    },
    {
        "type": "객관식",
        "question": "다음 중 맞춤법이 올바른 문장은?",
        "context": "",
        "options": ["선생님이 잘못을 닥달하실 때도", "선생님이 잘못을 닦달하실 때도", "선생님이 잘못을 닦딸하실 때도", "선생님이 잘못을 닥딸하실 때도"],
        "answer": 2,
        "explanation": "남을 몹시 몰아대거나 나무라는 것은 '닦달하다'가 맞습니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "달걀 ( )는 일반 쓰레기로 배출할게.",
        "options": ["껍질", "껍데기", "꺼풀", "피부"],
        "answer": 2,
        "explanation": "달걀이나 조개처럼 겉을 싸고 있는 단단한 물질은 '껍데기', 사과나 귤처럼 물체의 겉을 싸고 있는 무르거나 질긴 물질은 '껍질'입니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "바른 인성 함양을 ( )하고, 상처 주는 것을 ( )하자.",
        "options": ["지양, 지향", "지향, 지양", "지향, 지향", "지양, 지양"],
        "answer": 2,
        "explanation": "'지향(志向)'은 어떤 목표로 뜻이 쏠리는 것이고, '지양(止揚)'은 더 높은 단계로 오르기 위해 어떠한 것을 하지 않는 것입니다. 좋은 것은 지향하고, 나쁜 것은 지양해야 합니다."
    },
    {
        "type": "객관식",
        "question": "다음 중 표기가 올바른 낱말은?",
        "context": "좋아하는 사람과 놀며 ( )처럼 일어나자.",
        "options": ["오뚝이", "오뚜기", "오뚝기", "오뚜끼"],
        "answer": 1,
        "explanation": "'오뚝하다'라는 형용사의 어근 '오뚝'에 '-이'가 붙어 명사가 된 말이므로 원형을 밝혀 '오뚝이'로 적습니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "아이스크림보다 식혜가 ( ).",
        "options": ["낫다", "낳다", "낮다", "낯다"],
        "answer": 1,
        "explanation": "'더 좋다'라는 뜻은 '낫다'입니다. '낳다'는 아이를 낳을 때, '낮다'는 높이가 낮을 때 씁니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "다양한 색을 ( ) 코스모스를 볼 수 있다.",
        "options": ["띈", "띤", "뜬", "뛴"],
        "answer": 2,
        "explanation": "빛깔이나 색채 등을 가지다는 '띠다'가 맞습니다. (활용: 띠다 -> 띤)"
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "선생님, 우리 나중에 꼭 다시 ( ).",
        "options": ["뵈요", "봬요", "베요", "배요"],
        "answer": 2,
        "explanation": "'뵈어요'의 준말이므로 '봬요'가 올바른 표기입니다."
    },
    {
        "type": "객관식",
        "question": "다음 중 맞춤법이 올바른 것은?",
        "context": "물건 하나에도 다양한 환경 문제가 ( ) 있다.",
        "options": ["얽히고설켜", "얼키고설켜", "얽히고섥혀", "얼키고설혀"],
        "answer": 1,
        "explanation": "'얽히다'와 '설키다'가 합쳐진 말이므로 '얽히고설키다'가 맞습니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "수업 방해를 하고 ( ).",
        "options": ["궁시렁거렸다", "구시렁거렸다", "궁시런거렸다", "구시런거렸다"],
        "answer": 2,
        "explanation": "못마땅하여 군소리를 듣기 싫도록 자꾸 하다'는 '구시렁거리다'가 표준어입니다."
    },
    {
        "type": "객관식",
        "question": "다음 중 표기가 올바른 낱말은?",
        "context": "( ) 않는 겸손한 사람에게서 빛이 난다.",
        "options": ["으스대지", "으시대지", "으쓰대지", "으씨대지"],
        "answer": 1,
        "explanation": "우쭐거리며 뽐내다는 '으스대다'가 맞습니다. '으시대다'는 틀린 표현입니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "선배에게 ( ) 대고 반말이야?",
        "options": ["얻다", "엇다", "엏다", "어따"],
        "answer": 1,
        "explanation": "'어디에다'의 준말인 '얻다'가 올바른 표현입니다."
    },
    {
        "type": "객관식",
        "question": "다음 문장의 ( ) 안에 들어갈 알맞은 말은?",
        "context": "( ) 울적한 날에는 친구가 고체 샴푸를 건넸다.",
        "options": ["괜스레", "괜시리", "갠스레", "갠시리"],
        "answer": 1,
        "explanation": "까닭 없이 공연히'라는 뜻의 부사는 '괜스레'가 표준어입니다."
    }
]

# ---------------------------------------------------------
# [CSV 파일 생성 함수]
# ---------------------------------------------------------
def create_korean_problem_bank(filename="5학년_국어_문제은행.csv"):
    try:
        # utf-8-sig는 엑셀에서 한글 깨짐을 방지합니다.
        with open(filename, mode='w', newline='', encoding='utf-8-sig') as file:
            writer = csv.writer(file)
            
            # 헤더(제목) 작성
            writer.writerow(["번호", "문제유형", "질문", "지문/보기내용", "선택지1", "선택지2", "선택지3", "선택지4", "정답번호", "해설"])
            
            # 데이터 작성
            for i, q in enumerate(quiz_data, 1):
                row = [
                    i,
                    q["type"],
                    q["question"],
                    q["context"],
                    q["options"][0],
                    q["options"][1],
                    q["options"][2],
                    q["options"][3],
                    q["answer"],
                    q["explanation"]
                ]
                writer.writerow(row)
                
        print(f"✅ '{filename}' 파일이 성공적으로 생성되었습니다!")
        print(f"총 {len(quiz_data)}개의 5학년 국어(맞춤법/어휘) 문제가 포함되어 있습니다.")
        
    except Exception as e:
        print(f"❌ 파일 생성 중 오류가 발생했습니다: {e}")

# 스크립트 실행
if __name__ == "__main__":
    create_korean_problem_bank()