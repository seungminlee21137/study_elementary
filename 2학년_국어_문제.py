import csv
import random

# ==========================================
# 1. 사용자가 제공한 2학년 국어 문장 데이터베이스
# ==========================================
vocab_db = [
    # [난이도 상] 받침과 모음이 어려운 단어들
    {"w": "헬리콥터", "wrong": ["헬리곱터", "헬리콤터", "헤리콥터"], "sent": "모두 다 ____ 되어 빙글빙글 돌아요."},
    {"w": "짜장면", "wrong": ["자장면", "짜잔면", "자잔면"], "sent": "오늘 급식은 맛있는 ____이다!"},
    {"w": "곯아떨어졌어", "wrong": ["골아떨어졌어", "곪아떨어졌어", "골라떨어졌어"], "sent": "너무 지쳐서 집에 오자마자 ____."},
    {"w": "강아지풀", "wrong": ["강아지뿔", "강아지불", "강아지플"], "sent": "길가에 쓸모없는 ____이 자랐어요."},
    {"w": "깜빡", "wrong": ["껌뻑", "깜박", "끔뻑"], "sent": "가위를 ____ 잊고 안 가져왔어요."},
    {"w": "부릅뜨고", "wrong": ["부릅트고", "불읍뜨고", "무릅뜨고"], "sent": "눈을 ____ 말했어요."},
    {"w": "손뼉", "wrong": ["손벽", "손뻭", "손빡"], "sent": "공연이 끝나고 ____을 쳤어요."},
    {"w": "두리번거렸지요", "wrong": ["두리번거려찌요", "두리번거려지요", "두리벙거렸지요"], "sent": "주변을 ____."},
    {"w": "들썩거렸습니다", "wrong": ["들석거렸습니다", "들썩거려슴니다", "들썩거려씀니다"], "sent": "신이나서 어깨를 ____."},
    {"w": "소쿠리", "wrong": ["소구리", "쇼쿠리", "소꾸리"], "sent": "감자를 한 ____ 꺼내 들고 웃으셨어요."},
    {"w": "들꽃조차", "wrong": ["들꽃조차도", "들꽃마저", "들꽃까지"], "sent": "너무 황량해서 ____ 없었습니다."},
    {"w": "황량해", "wrong": ["황양해", "항량해", "황랑해"], "sent": "이곳은 사막처럼 ____."},
    {"w": "뒤숭숭한", "wrong": ["뒤숭숭안", "뒤숭승한", "뒤숭숭한"], "sent": "걱정이 있어서 마음이 ____."},
    {"w": "싱크대", "wrong": ["싱크데", "신크대", "씽크대"], "sent": "우유를 ____에 부어요."},
    {"w": "누리집", "wrong": ["누리짐", "누리지", "우리집"], "sent": "학교 ____을 사용해 정보를 찾아요."},
    {"w": "떡볶이", "wrong": ["떡복이", "떡보끼", "떡뽂이"], "sent": "____ 집을 지나서 집으로 가요."},
    {"w": "본체만체하거나", "wrong": ["본체만체하거나", "본채만채하거나", "본체만채하거나"], "sent": "친구를 보고도 ____ 지나갔어요."},
    {"w": "동그라미", "wrong": ["동구라미", "동글아미", "동그라니"], "sent": "종이에 바른 ____를 그려요."},
    {"w": "반질거리다", "wrong": ["반지러거리다", "반질거니다", "빤질거리다"], "sent": "코끝이 기름칠한 듯 ____."},
    {"w": "재롱둥이", "wrong": ["재롱동이", "제롱둥이", "재롱동이"], "sent": "우리 집 강아지는 ____예요."},
    {"w": "허둥지둥", "wrong": ["허둥지동", "허동지동", "호둥지둥"], "sent": "늦을까 봐 ____ 따라갔습니다."},
    {"w": "깜빡깜빡", "wrong": ["깜박깜박", "껌뻑껌뻑", "끔뻑끔뻑"], "sent": "손전등 불빛이 ____ 합니다."},
    {"w": "가랑비", "wrong": ["가낭비", "거랑비", "가랑이"], "sent": "보슬보슬 ____와 이슬비가 내려요."},
    {"w": "책갈피", "wrong": ["책깔피", "책갈비", "책칼피"], "sent": "낙엽으로 예쁜 ____를 만들어요."},
    {"w": "콩닥콩닥", "wrong": ["콩닥꽁닥", "공닥공닥", "쿵덕쿵덕"], "sent": "발표할 때 가슴이 ____ 뛰었다."},
    {"w": "거북선", "wrong": ["거북썬", "거북성", "꺼북선"], "sent": "이순신 장군님의 튼튼한 ____."},
    {"w": "올록볼록", "wrong": ["올록볼록", "올룩볼룩", "올록뽈록"], "sent": "엠보싱 휴지는 ____ 껍데기 같아요."},
    {"w": "새콤달콤", "wrong": ["새콤달꼼", "세콤달콤", "새쿰달쿰"], "sent": "____ 보랏빛 포도가 맛있어요."},
    {"w": "뒤뚱뒤뚱", "wrong": ["뒤뚱디뚱", "디뚱디뚱", "뒤뚱뒤둥"], "sent": "오리들은 ____ 걸으며 물가로 가요."},
    {"w": "차곡차곡", "wrong": ["차곡짜곡", "자곡자곡", "차국차국"], "sent": "바구니에 고구마를 ____ 담아요."},
    {"w": "뒷산", "wrong": ["뒤산", "뒷싼", "뒫산"], "sent": "____ 마루에 걸린 구름이 멋져요."},
    {"w": "시끌벅적한", "wrong": ["시끌벅적안", "시끌벅쩍한", "씨끌벅적한"], "sent": "시장에는 ____ 소리가 들려요."},
    {"w": "무릎", "wrong": ["무릅", "무룹", "무릊"], "sent": "넘어져서 다친 ____이 아팠어."},
    {"w": "반듯이", "wrong": ["반드시", "반드씨", "빤듯이"], "sent": "학용품을 책상 위에 ____ 놓았다."},
    {"w": "휘둥그레지다", "wrong": ["휘둥그래지다", "히둥그레지다", "휘동그레지다"], "sent": "놀라운 광경에 눈이 ____."},
    {"w": "영양분", "wrong": ["영양뿐", "영앙분", "녕양분"], "sent": "식물은 흙에서 ____을 얻어요."},
    {"w": "볼우물", "wrong": ["보루물", "볼우믈", "볼우무"], "sent": "웃을 때 생기는 ____이 참 예뻐요."},
    {"w": "허수아비", "wrong": ["허수애비", "허수아비", "허슈아비"], "sent": "새떼를 쫓아 주는 ____."},
    {"w": "험상궂게", "wrong": ["험상굳게", "험상굿게", "험상궂개"], "sent": "그 물고기는 ____ 생겼어요."},
    {"w": "어깨동무", "wrong": ["어께동무", "어깨동모", "억깨동무"], "sent": "친한 친구와 ____한 두 사람."},
    {"w": "몫", "wrong": ["목", "몱", "뫏"], "sent": "이건 내가 해야 할 내 ____이 너무 많다."},
    {"w": "넋", "wrong": ["넉", "넏", "넔"], "sent": "너무 놀라서 ____이 나간 표정이구나."},
    {"w": "때때옷", "wrong": ["때때옫", "떼떼옷", "대대옷"], "sent": "설날에 일곱 빛 ____ 곱게 입고 세배해요."},
    
    # [띄어쓰기 및 조사]
    {"w": "마주 앉은", "wrong": ["마주앉은", "마주안은", "마주 안은"], "sent": "내 앞에 ____ 친구가 웃어요."},
    {"w": "할 수", "wrong": ["할수", "하ㄹ수", "할 수"], "sent": "우리는 무엇이든 ____ 있어요."},
    {"w": "읽을 수", "wrong": ["읽을수", "일글 수", "익을 수"], "sent": "이 글자는 너무 작아서 ____ 없으니까 말이야."},
    {"w": "오랫동안", "wrong": ["오래동안", "오랫 동안", "오래 동안"], "sent": "____ 기억해 주었으면 좋겠어."},
    {"w": "몇 시에", "wrong": ["몇시에", "몆 시에", "면 시에"], "sent": "공연은 ____ 시작하나요?"},
    {"w": "틀림없이", "wrong": ["틀림 없이", "틀님없이", "틀림업이"], "sent": "그 소리를 ____ 들었네."},
    {"w": "잃어버렸다", "wrong": ["일어버렸다", "잃어 버렸다", "잊어버렸다"], "sent": "숲속에서 길을 ____."},
    {"w": "바래고", "wrong": ["바라고", "바레고", "빨래고"], "sent": "오래된 책의 색이 ____ 있어요."},
    {"w": "가르쳐", "wrong": ["가르처", "가리쳐", "가르켜"], "sent": "선생님이 국어를 ____ 주십니다."},
    {"w": "잊어버렸어요", "wrong": ["잃어버렸어요", "이저버렸어요", "잊어 버렸어요"], "sent": "현관 비밀번호를 ____."},
    {"w": "파헤치며", "wrong": ["파해치며", "파해치며", "파헤치며"], "sent": "멧돼지가 밭을 마구 ____."},
    {"w": "빠져들었어", "wrong": ["빠저들었어", "빠져 들었어", "바져들었어"], "sent": "재미있는 이야기 속으로 ____."},
]

# ==========================================
# 2. 문제 생성 로직 (3가지 핵심 유형만 생성)
# ==========================================
def generate_questions(target_count=2000):
    questions = []
    
    # 목표 개수가 찰 때까지 무한 반복
    while len(questions) < target_count:
        for item in vocab_db:
            if len(questions) >= target_count: break
            
            # 오답 리스트 섞기
            wrongs = item['wrong'][:]
            random.shuffle(wrongs)

            # [유형 1] 맞춤법 고르기
            q1 = {
                "q": "다음 중 맞춤법(띄어쓰기)이 올바른 것을 고르세요.",
                "a": item['w'],
                "w1": wrongs[0],
                "w2": wrongs[1],
                "w3": wrongs[2]
            }
            questions.append(q1)

            # [유형 2] 빈칸 채우기
            if len(questions) >= target_count: break
            
            # 보기 순서 다시 섞기
            random.shuffle(wrongs)
            q2 = {
                "q": f"다음 문장의 빈칸에 들어갈 올바른 낱말은? '{item['sent']}'",
                "a": item['w'],
                "w1": wrongs[0],
                "w2": wrongs[1],
                "w3": wrongs[2]
            }
            questions.append(q2)

            # [유형 3] 고쳐쓰기 (틀린 글자 찾기)
            if len(questions) >= target_count: break
            
            target_wrong = wrongs[0] # 문장에 넣을 틀린 단어
            wrong_sentence = item['sent'].replace("____", target_wrong)
            
            # 만약 문장에 빈칸(____)이 없다면(즉, 이미 완성된 문장이었다면) 단어를 치환
            if "____" not in item['sent']:
                 wrong_sentence = item['sent'].replace(item['w'], target_wrong)

            q3 = {
                "q": f"다음 문장에서 틀린 글자를 찾아 바르게 고친 것은? '{wrong_sentence}'",
                "a": f"{target_wrong} -> {item['w']}",
                "w1": f"{target_wrong} -> {wrongs[1]}", 
                "w2": "틀린 글자가 없다.",               
                "w3": f"{item['w']} -> {target_wrong}"   
            }
            questions.append(q3)

    return questions[:target_count]

# ==========================================
# 3. CSV 파일 저장
# ==========================================
final_data = generate_questions(2000)

filename = "2학년_국어_문제은행.csv"

with open(filename, 'w', newline='', encoding='utf-8-sig') as f:
    writer = csv.writer(f)
    writer.writerow(["id", "grade", "subject", "q", "a", "w1", "w2", "w3"])
    
    for idx, item in enumerate(final_data, 1):
        row = [
            2000 + idx,       # id
            "2",              # grade
            "korean",         # subject
            item["q"],        # q
            item["a"],        # a
            item["w1"],       # w1
            item["w2"],       # w2
            item["w3"]        # w3
        ]
        writer.writerow(row)

print(f"=========================================")
print(f"'{filename}' 파일 생성이 완료되었습니다!")
print(f"사용자 문장 기반으로 총 {len(final_data)}문제가 만들어졌습니다.")
print(f"=========================================")